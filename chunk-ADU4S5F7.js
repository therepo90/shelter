import{b as J,c as Q}from"./chunk-W376RTDO.js";import"./chunk-VQJLRZDC.js";import{a as Z,b as v,c as q}from"./chunk-HVCR7BTE.js";import{$a as j,Ba as F,D as u,G as d,H as n,I as t,J as b,K as M,L as S,N as k,O as _,P as f,W as O,X as a,Y as p,Z as T,_a as w,ab as R,bb as $,cb as V,d as P,da as z,ga as D,gb as A,ha as B,hb as W,ia as L,ib as N,jb as X,ka as C,l as x,mb as U,nb as G,o as E,ob as H,p as I,rb as K,v as r,z as h}from"./chunk-GG3DJ3GA.js";import"./chunk-JBCXF56H.js";import"./chunk-QUJFQN2Y.js";import"./chunk-6HU4TFNA.js";import"./chunk-SROQCUWQ.js";import"./chunk-TX4Q6HNZ.js";import"./chunk-2J4NCJOL.js";import"./chunk-LBCXAYCZ.js";import"./chunk-5UYKJVW7.js";import"./chunk-J7EDNWVB.js";import"./chunk-BMJVVMK5.js";import"./chunk-NHGX5HSY.js";import"./chunk-I3JQUJOC.js";import"./chunk-7LKXLI3U.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-BZSE2QSZ.js";import"./chunk-CKP3SGE2.js";import"./chunk-DW55EUKJ.js";import"./chunk-JNSPDWUV.js";import"./chunk-HNZXAMTE.js";import"./chunk-SCQXEI7G.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-H3Z6NBHK.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as m}from"./chunk-2R6CW7ES.js";var Y=(()=>{let i=class i{constructor(){this.modalCtrl=x(v)}cancel(){this.modalCtrl.dismiss(null,"cancel")}confirm(){this.modalCtrl.dismiss(null,"confirm")}};i.\u0275fac=function(c){return new(c||i)},i.\u0275cmp=h({type:i,selectors:[["app-confirm-walk-modal"]],inputs:{dog:"dog"},decls:7,vars:1,consts:[[1,"confirm-modal-wrapper"],[1,"confirm-modal-dogname"],["expand","block","color","success",1,"big-confirm-btn",3,"click"],["expand","block","color","danger",1,"big-cancel-btn",3,"click"]],template:function(c,s){c&1&&(n(0,"div",0)(1,"div",1),a(2),t(),n(3,"ion-button",2),_("click",function(){return s.confirm()}),a(4,"Potwierd\u017A"),t(),n(5,"ion-button",3),_("click",function(){return s.cancel()}),a(6,"Anuluj"),t()()),c&2&&(r(2),p(s.dog==null?null:s.dog.name))},dependencies:[C,w],styles:[".confirm-modal-wrapper[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border-radius:1.5rem;box-shadow:0 2px 16px #0000002e;padding:1.2rem 2.2rem 1.5rem;display:flex;flex-direction:column;align-items:center;min-width:220px;max-width:90vw;z-index:1000}.confirm-modal-dogname[_ngcontent-%COMP%]{font-size:2.1rem;font-weight:700;margin-bottom:2.2rem;color:#222;text-align:center}.big-confirm-btn[_ngcontent-%COMP%], .big-cancel-btn[_ngcontent-%COMP%]{font-size:2.1rem;min-height:4.2rem;border-radius:2.2rem;margin:.7rem 0;width:100%;font-weight:700}.big-confirm-btn[_ngcontent-%COMP%]{margin-bottom:2.2rem}.big-cancel-btn[_ngcontent-%COMP%]{font-size:2.3rem;margin-top:2rem}"]});let e=i;return e})();var te=(e,i)=>({"green-btn":e,"red-btn":i});function ne(e,i){e&1&&(n(0,"h2",16),a(1,"LIVE"),t())}function ie(e,i){e&1&&(n(0,"h2",16),a(1,"Testing"),t())}function oe(e,i){e&1&&b(0,"ion-spinner",17)}function re(e,i){if(e&1&&(n(0,"ion-text",18),a(1),t()),e&2){let l=f();r(),p(l.loadError)}}function ae(e,i){if(e&1&&(n(0,"ion-text",18),a(1),t()),e&2){let l=f(3);r(),p(l.markError)}}function le(e,i){if(e&1&&(M(0),n(1,"div",26)(2,"div",27),a(3),t(),n(4,"span",28),a(5),t()(),S()),e&2){let l=i.$implicit,o=f(4);r(2),O("background",l.value?"#2dd36f":"#eb445a"),r(),p(l.value),r(2),p(o.getShortDate(l.date))}}function se(e,i){if(e&1&&(n(0,"div",25),u(1,le,6,4,"ng-container",21),t()),e&2){let l=f().$implicit;r(),d("ngForOf",l.recentPresence)}}function ce(e,i){if(e&1){let l=k();n(0,"tr")(1,"td"),a(2),t(),n(3,"td")(4,"ion-button",22),_("click",function(){let c=E(l).$implicit,s=f(2);return I(s.onDogClick(c))}),a(5),t(),u(6,ae,2,1,"ion-text",14)(7,se,2,1,"div",23),t(),n(8,"td",24),a(9),t()()}if(e&2){let l=i.$implicit,o=f(2);r(2),p(l.box),r(2),d("ngClass",z(7,te,l.status,!l.status))("disabled",l.status==="X"),r(),p(l.name),r(),d("ngIf",o.markError),r(),d("ngIf",l.recentPresence),r(2),T(" ",l.status," ")}}function de(e,i){if(e&1&&(n(0,"div",19)(1,"table",20)(2,"thead")(3,"tr")(4,"th"),a(5,"BOX"),t(),n(6,"th"),a(7,"IMI\u0118"),t(),n(8,"th"),a(9,"STATUS"),t()()(),n(10,"tbody"),u(11,ce,10,10,"tr",21),t()()()),e&2){let l=f();r(11),d("ngForOf",l.dogs)}}var ke=(()=>{let i=class i{constructor(){this.dogs=[],this.selectedDogs=[],this.isLoading=!1,this.loadError=null,this.markError=null,this.dogsService=x(J),this.loadingCtrl=x(Z),this.toastCtrl=x(q),this.modalCtrl=x(v),this.live=void 0}ngOnInit(){return m(this,null,function*(){yield this.loadDogs(),this.isLive().subscribe(o=>{this.live=o})})}ionViewWillEnter(){return m(this,null,function*(){yield this.loadDogs()})}loadDogs(){return m(this,null,function*(){this.isLoading=!0,this.loadError=null;try{this.dogsService.getAllDogs().subscribe({next:o=>m(this,null,function*(){let c=yield this.dogsService.getSelectedBoxes();this.dogs=Q(o.filter(s=>c.some(g=>g.box===s.box))),this.isLoading=!1}),error:()=>{this.loadError="B\u0142\u0105d wczytywania piesk\xF3w",this.isLoading=!1}})}catch{this.loadError="B\u0142\u0105d wczytywania piesk\xF3w",this.isLoading=!1}})}onDogClick(o){return m(this,null,function*(){let c=yield this.modalCtrl.create({component:Y,componentProps:{dog:o},showBackdrop:!0});yield c.present();let{role:s}=yield c.onDidDismiss();if(s!=="confirm")return;this.markError=null;let g=yield this.loadingCtrl.create({message:`Zapisuj\u0119 spacer dla: ${o.name}`});yield g.present(),this.dogsService.sendDogClick(o).subscribe({next:()=>m(this,null,function*(){yield g.dismiss(),o.status="X",(yield this.toastCtrl.create({message:`Spacer zapisany dla: ${o.name}`,duration:1200,color:"success"})).present()}),error:()=>m(this,null,function*(){yield g.dismiss(),this.markError=`B\u0142\u0105d zapisywania spaceru dla: ${o.name}`,(yield this.toastCtrl.create({message:`B\u0142\u0105d zapisywania spaceru dla: ${o.name}`,duration:2e3,color:"danger"})).present()})})})}doRefresh(o){return m(this,null,function*(){yield this.loadDogs(),o.target.complete()})}isLive(){return this.dogsService.getCfg().pipe(P(o=>o.live))}getShortDate(o){return o.split("/").slice(0,2).join("/")}};i.\u0275fac=function(c){return new(c||i)},i.\u0275cmp=h({type:i,selectors:[["app-tab1"]],decls:32,vars:7,consts:[[3,"translucent"],["class","live",4,"ngIf"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"ion-padding-top","ion-padding-start"],[1,"ion-align-items-center"],["size","auto",1,""],["name","ellipse","color","danger"],["size","4",1,"ion-no-padding"],["name","ellipse","color","success"],["size","12"],["collapse","condense"],["size","large"],["name","crescent","class","ion-margin",4,"ngIf"],["color","danger",4,"ngIf"],["class","dogs-table-wrapper",4,"ngIf"],[1,"live"],["name","crescent",1,"ion-margin"],["color","danger"],[1,"dogs-table-wrapper"],[1,"dogs-table"],[4,"ngFor","ngForOf"],["expand","block",1,"dog-name-btn",3,"click","ngClass","disabled"],["style","display:flex; gap:4px; margin-top:4px;justify-content:space-between;",4,"ngIf"],[1,"ion-text-center"],[2,"display","flex","gap","4px","margin-top","4px","justify-content","space-between"],[2,"display","flex","flex-direction","column","align-items","center"],[2,"width","16px","height","16px","border-radius","3px","margin-bottom","2px"],[2,"font-size","0.9em","color","#888"]],template:function(c,s){c&1&&(n(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),a(3," Spacery "),u(4,ne,2,0,"h2",1)(5,ie,2,0,"h2",1),t()()(),n(6,"ion-content",2)(7,"ion-refresher",3),_("ionRefresh",function(y){return s.doRefresh(y)}),b(8,"ion-refresher-content"),t(),n(9,"ion-grid",4)(10,"ion-row",5)(11,"ion-col",6),b(12,"ion-icon",7),t(),n(13,"ion-col",8),a(14,"nie by\u0142"),t()(),n(15,"ion-row",5)(16,"ion-col",6),b(17,"ion-icon",9),t(),n(18,"ion-col",8),a(19,"by\u0142"),t()(),n(20,"ion-row")(21,"ion-col",10)(22,"small")(23,"i"),a(24,"Kliknij w imi\u0119 psa, aby zaznaczy\u0107 spacer ca\u0142ego boxu"),t()()()()(),n(25,"ion-header",11)(26,"ion-toolbar")(27,"ion-title",12),a(28,"Spacery"),t()()(),u(29,oe,1,0,"ion-spinner",13)(30,re,2,1,"ion-text",14)(31,de,12,1,"div",15),t()),c&2&&(d("translucent",!0),r(4),d("ngIf",s.live),r(),d("ngIf",!s.live),r(),d("fullscreen",!0),r(23),d("ngIf",s.isLoading),r(),d("ngIf",s.loadError),r(),d("ngIf",!s.isLoading&&!s.loadError))},dependencies:[C,D,B,L,F,V,H,U,w,K,G,R,$,N,j,X,A,W],styles:['@charset "UTF-8";.dogs-table-wrapper[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center}.dogs-table[_ngcontent-%COMP%]{width:100%;max-width:500px;border-collapse:separate;border-spacing:0 1rem}.dogs-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .dogs-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;padding:.5rem 1rem}.dog-name-btn[_ngcontent-%COMP%]{font-size:1.3rem;border-radius:2rem;width:100%;font-weight:700;box-shadow:0 2px 8px #e5393526;margin:.2rem 0;min-height:5.5rem;padding-top:1.5rem;padding-bottom:1.5rem}.dog-name-btn.disabled[_ngcontent-%COMP%]{opacity:1}.red-btn[_ngcontent-%COMP%]{--background: #e53935;--color: #fff}.green-btn[_ngcontent-%COMP%]{--background: #43a047;--color: #fff}@media (max-width: 600px){.dogs-table[_ngcontent-%COMP%]{font-size:.95rem;max-width:100%}.dog-name-btn[_ngcontent-%COMP%]{font-size:1rem;min-height:4rem;padding-top:1.1rem;padding-bottom:1.1rem;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}}.legend-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:.7rem auto .2rem;font-size:.93rem;background:#fff;border-radius:1.2rem;box-shadow:0 2px 8px #00000012;padding:.5rem 1.2rem .7rem;min-width:120px;max-width:220px}.legend-title[_ngcontent-%COMP%]{font-size:.92em;color:#888;font-weight:500;margin-bottom:.2em;letter-spacing:.03em;text-align:center}.legend-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.18em;margin-bottom:.2em;align-items:center}.legend-row[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.1em}.legend-dot[_ngcontent-%COMP%]{display:inline-block;width:1em;height:1em;border-radius:50%;margin-right:.35em;vertical-align:middle;border:1.5px solid #eee}.red-dot[_ngcontent-%COMP%]{background:#e53935}.green-dot[_ngcontent-%COMP%]{background:#43a047}.legend-label[_ngcontent-%COMP%]{color:#444;font-size:.97em}.legend-instruction[_ngcontent-%COMP%]{width:100%;text-align:center;color:#aaa;font-size:.87em;font-style:italic;margin-top:.2em;margin-bottom:.2em}.live[_ngcontent-%COMP%]{color:gray;font-size:.6rem;display:inline-block}']});let e=i;return e})();export{ke as Tab1Page};
