import{f as oe,h as re}from"./chunk-RS2UFXYS.js";import{d as ee,f as te}from"./chunk-64UDITVO.js";import{Aa as V,C as T,F as M,G as L,H as K,I as N,Sa as X,Ta as Y,Ua as G,Va as J,Wa as q,Xa as Q,ga as D,ia as O,ja as z,k as x,l as b,la as F,ma as H,oa as $,ob as Z,qa as W,ra as j,sa as B,y as U}from"./chunk-OCOLT4XC.js";import"./chunk-EGBFUY26.js";import{a as y}from"./chunk-VQJLRZDC.js";import"./chunk-JBCXF56H.js";import"./chunk-QUJFQN2Y.js";import"./chunk-6HU4TFNA.js";import"./chunk-SROQCUWQ.js";import"./chunk-TX4Q6HNZ.js";import"./chunk-2J4NCJOL.js";import"./chunk-LBCXAYCZ.js";import"./chunk-5UYKJVW7.js";import"./chunk-J7EDNWVB.js";import"./chunk-BMJVVMK5.js";import"./chunk-NHGX5HSY.js";import"./chunk-I3JQUJOC.js";import"./chunk-7LKXLI3U.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-BZSE2QSZ.js";import"./chunk-CKP3SGE2.js";import"./chunk-DW55EUKJ.js";import"./chunk-JNSPDWUV.js";import"./chunk-HNZXAMTE.js";import"./chunk-SCQXEI7G.js";import"./chunk-PGY34PD4.js";import"./chunk-GYLY2RJE.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-H3Z6NBHK.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import{g as I}from"./chunk-2R6CW7ES.js";var ne=[{path:"",loadChildren:()=>import("./chunk-T5TAJDAX.js").then(i=>i.routes)}];var k=y("SplashScreen",{web:()=>import("./chunk-M7UFVKZR.js").then(i=>new i.SplashScreenWeb)});var le="__capgo_keep_url_path_after_reload",_="__capgo_history_stack__";var fe=typeof window<"u"&&typeof document<"u"&&typeof history<"u";if(fe){let i=window;if(!i.__capgoHistoryPatched){i.__capgoHistoryPatched=!0;let c=()=>{try{if(i.__capgoKeepUrlPathAfterReload)return!0}catch{}try{return window.localStorage.getItem(le)==="1"}catch{return!1}},m=()=>{try{let e=window.sessionStorage.getItem(_);if(!e)return{stack:[],index:-1};let t=JSON.parse(e);return!t||!Array.isArray(t.stack)||typeof t.index!="number"?{stack:[],index:-1}:t}catch{return{stack:[],index:-1}}},p=(e,t)=>{try{window.sessionStorage.setItem(_,JSON.stringify({stack:e,index:t}))}catch{}},s=()=>{try{window.sessionStorage.removeItem(_)}catch{}},a=e=>{try{let t=e??window.location.href,r=new URL(t instanceof URL?t.toString():t,window.location.href);return`${r.pathname}${r.search}${r.hash}`}catch{return null}},u=(e,t)=>{if(e.length<=100)return{stack:e,index:t};let r=e.length-100,o=e.slice(r),n=Math.max(0,t-r);return{stack:o,index:n}},ae=e=>{document.readyState==="complete"||document.readyState==="interactive"?e():window.addEventListener("DOMContentLoaded",e,{once:!0})},d=!1,h=!1,w=!1,v=()=>{if(!d)return;let e=m(),t=a();if(t){if(e.stack.length===0){e.stack.push(t),e.index=0,p(e.stack,e.index);return}(e.index<0||e.index>=e.stack.length)&&(e.index=e.stack.length-1),e.stack[e.index]!==t&&(e.stack[e.index]=t,p(e.stack,e.index))}},C=(e,t)=>{if(!d||h)return;let r=a(e);if(!r)return;let{stack:o,index:n}=m();o.length===0?(o.push(r),n=o.length-1):t?((n<0||n>=o.length)&&(n=o.length-1),o[n]=r):n>=o.length-1?(o.push(r),n=o.length-1):(o=o.slice(0,n+1),o.push(r),n=o.length-1),{stack:o,index:n}=u(o,n),p(o,n)},ce=()=>{if(!d||h)return;let e=m();if(e.stack.length===0){v();return}let t=e.index>=0&&e.index<e.stack.length?e.index:e.stack.length-1,r=a();if(e.stack.length===1&&r===e.stack[0])return;let o=e.stack[0];if(!o)return;h=!0;try{history.replaceState(history.state,document.title,o);for(let g=1;g<e.stack.length;g+=1)history.pushState(history.state,document.title,e.stack[g])}catch{h=!1;return}h=!1;let n=e.stack.length-1,R=t-n;R!==0?history.go(R):(history.replaceState(history.state,document.title,e.stack[t]),window.dispatchEvent(new PopStateEvent("popstate")))},A=()=>{!d||w||(w=!0,ae(()=>{w=!1,ce()}))},l=null,f=null,P=()=>{if(!d||h)return;let e=a();if(!e)return;let t=m(),r=t.stack.lastIndexOf(e);r>=0?t.index=r:(t.stack.push(e),t.index=t.stack.length-1);let o=u(t.stack,t.index);p(o.stack,o.index)},pe=()=>{l&&f||(l=history.pushState,f=history.replaceState,history.pushState=function(t,r,o){let n=l?.call(history,t,r,o);return C(o,!1),n},history.replaceState=function(t,r,o){let n=f?.call(history,t,r,o);return C(o,!0),n},window.addEventListener("popstate",P))},de=()=>{l&&(history.pushState=l,l=null),f&&(history.replaceState=f,f=null),window.removeEventListener("popstate",P)},S=e=>{if(d===e){d&&(v(),A());return}d=e,d?(pe(),v(),A()):(de(),s())};window.addEventListener("CapacitorUpdaterKeepUrlPathAfterReload",e=>{var t;let r=e,o=(t=r?.detail)===null||t===void 0?void 0:t.enabled;typeof o=="boolean"?(i.__capgoKeepUrlPathAfterReload=o,S(o)):(i.__capgoKeepUrlPathAfterReload=!0,S(!0))}),S(c())}}var E=y("CapacitorUpdater",{web:()=>import("./chunk-MHLSCMLO.js").then(i=>new i.CapacitorUpdaterWeb)});function he(i,c){i&1&&(L(0,"ion-app"),N(1,"ion-router-outlet"),K())}var ie=(()=>{let c=class c{constructor(){this.initialized=!1,this.platform=x(V),this.dogsService=x(te),this.platform.ready().then(()=>{this.checkForUpdate()})}checkForUpdate(){return I(this,null,function*(){try{console.log("Checking for updates...");let p=yield fetch("https://raw.githubusercontent.com/therepo90/shelter/refs/heads/main/.git-version");if(!p.ok)throw new Error("Failed to fetch version info");let s=(yield p.text()).trim(),a=yield this.dogsService.getVersion();if(console.log({version:s,localVersion:a}),s&&a&&s!==a){console.log(`Updating from version ${a} to ${s}`);let u=yield E.download({url:"https://therepo90.github.io/shelter/www.zip",version:s});k.show(),yield E.set({id:u.id}),yield this.dogsService.setVersion(s),window.location.reload()}else s&&!a?(console.log(`Setting initial version to ${s}`),yield this.dogsService.setVersion(s)):console.log(`App is up to date with version ${a}`);this.initialized=!0}catch(p){alert("Update check error: "+p)}finally{k.hide()}})}};c.\u0275fac=function(s){return new(s||c)},c.\u0275cmp=U({type:c,selectors:[["app-root"]],decls:1,vars:1,consts:[[4,"ngIf"]],template:function(s,a){s&1&&T(0,he,2,0,"ion-app",0),s&2&&M("ngIf",a.initialized)},dependencies:[O,D,Q,q],encapsulation:2});let i=c;return i})();var me=()=>re(),se=(i,c)=>typeof window>"u"?Promise.resolve():me().then(()=>oe([["pwa-camera-modal",[[1,"pwa-camera-modal",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],present:[64],dismiss:[64]}]]],["pwa-action-sheet",[[1,"pwa-action-sheet",{header:[1],cancelable:[4],options:[16],open:[32]}]]],["pwa-toast",[[1,"pwa-toast",{message:[1],duration:[2],closing:[32]}]]],["pwa-camera",[[1,"pwa-camera",{facingMode:[1,"facing-mode"],handlePhoto:[16],hidePicker:[4,"hide-picker"],handleNoDeviceError:[16],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"],photo:[32],photoSrc:[32],showShutterOverlay:[32],flashIndex:[32],hasCamera:[32],rotation:[32],deviceError:[32]}]]],["pwa-camera-modal-instance",[[1,"pwa-camera-modal-instance",{facingMode:[1,"facing-mode"],hidePicker:[4,"hide-picker"],noDevicesText:[1,"no-devices-text"],noDevicesButtonText:[1,"no-devices-button-text"]},[[16,"keyup","handleBackdropKeyUp"]]]]]],c));se(window);G();J();Y();z(ie,{providers:[F(H()),{provide:$,useClass:X},Z(),j(ne,B(W)),b(ee.forRoot({}))]});
